{
	"info": {
		"_postman_id": "40ce9f42-b43d-4b5b-8f22-9239711c1e74",
		"name": "Tkachenko QA Auto API Tests.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "41306527"
	},
	"item": [
		{
			"name": "New user",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let data = pm.response.json();\r",
							"\r",
							"pm.environment.set(\"token\", data.data.token);\r",
							"pm.environment.set(\"userId\", data.data.userId);\r",
							"pm.environment.set(\"password\", JSON.parse(pm.request.body.raw).password);\r",
							"const schema = {\r",
							"  type: \"object\",\r",
							"  properties: {\r",
							"    status: { type: \"string\" },\r",
							"    data: {\r",
							"      type: \"object\",\r",
							"      properties: {\r",
							"        userId: { type: \"number\" }\r",
							"      },\r",
							"      required: [\"userId\"]\r",
							"    }\r",
							"  },\r",
							"  required: [\"status\", \"data\"]\r",
							"};\r",
							"\r",
							"pm.test(\"Schema is valid\", function () {\r",
							"  pm.response.to.have.jsonSchema(schema);\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let r = Math.floor(Math.random() * 1000000);\r",
							"pm.environment.set(\"email\", `user${r}@test.com`);\r",
							"pm.environment.set(\"password\", `Qwerty${r}!`);\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"name\": \"John\",\r\n  \"lastName\": \"Snow\",\r\n  \"email\": \"{{email}}\",\r\n  \"password\": \"{{password}}\",\r\n\"repeatPassword\": \"{{password}}\"\r\n}\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}auth/signup",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"signup"
					]
				}
			},
			"response": []
		},
		{
			"name": "Token",
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"email\": \"tes123t@test.com\",\r\n  \"password\": \"Qwerty12345\"\r\n}\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/auth/signin",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"auth",
						"signin"
					]
				}
			},
			"response": []
		},
		{
			"name": "Update user",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let year = 1980 + Math.floor(Math.random() * 30);\r",
							"pm.environment.set(\"birthDate\", `${year}-05-01`);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const req = JSON.parse(pm.request.body.raw);\r",
							"const res = pm.response.json().data;\r",
							"\r",
							"pm.test(\"Profile matches request\", function () {\r",
							"    pm.expect(res).to.deep.include(req);\r",
							"});\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"name\": \"John\",\r\n  \"lastName\": \"Snow\",\r\n  \"phone\": \"18965415\",\r\n  \"photo\": null,\r\n  \"dateBirth\": \"{{birthDate}}\",\r\n  \"country\": \"Ukraine\",\r\n  \"city\": \"Kyiv\",\r\n  \"address\": \"Test street 1\",\r\n  \"currency\": \"usd\"\r\n}\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/users/profile",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"users",
						"profile"
					]
				}
			},
			"response": []
		},
		{
			"name": "Change password",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"UserId matches created user\", function () {\r",
							"    pm.expect(pm.response.json().data.userId)\r",
							"      .to.eql(pm.environment.get(\"userId\"));\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"oldPassword\": \"Qwerty12345\",\r\n    \"password\": \"NewP@ss123!\",\r\n    \"repeatPassword\": \"NewP@ss123!\"\r\n}\r\n\r\n\r\n\r\n\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/users/password",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"users",
						"password"
					]
				}
			},
			"response": []
		},
		{
			"name": "Logout",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Login status is ok\", function () {\r",
							"    pm.expect(pm.response.json().status).to.eql(\"ok\");\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"status\": \"ok\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/auth/logout",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"auth",
						"logout"
					]
				}
			},
			"response": []
		},
		{
			"name": "New password",
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"email\": \"tes123t@test.com\",\r\n  \"password\": \"Qwerty121212\"\r\n}\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/auth/signin",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"auth",
						"signin"
					]
				}
			},
			"response": []
		},
		{
			"name": "New car",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"carBrandId\": 1,\r\n  \"carModelId\": 1,\r\n  \"mileage\": 122\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/cars",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"cars"
					]
				}
			},
			"response": []
		},
		{
			"name": "Car expenses",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let last = pm.environment.get(\"lastExpense\") || 10;\r",
							"let next = last + Math.floor(Math.random() * 50) + 1;\r",
							"\r",
							"pm.environment.set(\"nextExpense\", next);\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Expense saved\", function () {\r",
							"    pm.expect(pm.response.json().status).to.eql(\"ok\");\r",
							"});\r",
							"\r",
							"// зберегти для наступного запиту\r",
							"pm.environment.set(\"lastExpense\", pm.environment.get(\"nextExpense\"));\r",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "\r\n{\r\n  \"carId\": 212678,\r\n  \"reportedAt\": \"2025-12-08\",\r\n  \"mileage\": 130,\r\n  \"liters\": 11,\r\n  \"totalCost\": 11,\r\n  \"forceMileage\": false\r\n}\r\n\r\n\r\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/expenses",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"expenses"
					]
				}
			},
			"response": []
		},
		{
			"name": "Delete",
			"request": {
				"method": "DELETE",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/users",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"users"
					]
				}
			},
			"response": []
		}
	]
}